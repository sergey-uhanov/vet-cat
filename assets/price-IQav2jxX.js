import{c as _,d as m,q as y,w as E,a as h,r as c,b as v,e as d,g as r,j as P,s as T,o as S,i as B}from"./firebase-C_D9rmmj.js";import{u as f}from"./use-query-DC4Lgv9E.js";import{c as g}from"./capitalize-name-C89BSpDV.js";async function b(n){const i=n!=="Все услуги"?n:null;try{const e=_(m,"price"),t=i?y(e,E("title","==",i)):y(e);return(await h(t)).docs.map(a=>({id:a.id,...a.data()}))}catch(e){console.error("Ошибка при получении документов:",e)}}function q(n){const i=c("ul","type-price__list");return n.forEach(e=>{const t=c("li","type-price__service-price"),s=c("p","type-price__name-service");s.textContent=e.name;const a=c("p","type-price__price-service");a.textContent=e.price,t.appendChild(s),t.appendChild(a),i.appendChild(t)}),i}function C(n){const i=document.createDocumentFragment();return n.forEach(e=>{const t=c("li",["tubs__lists-item","type-price"]),s=c("h5","type-price__title");s.textContent=e.title,t.appendChild(s);const a=c("p","type-price__description");a.textContent="Цены указаны в молдавских леях за одну процедуру/сеанс для одного животного",t.appendChild(a),e.categories&&e.categories.forEach(p=>{const o=c("div","type-price__sub-title");o.textContent=p.subTitle,t.appendChild(o),t.appendChild(q(p.services))}),e.services&&t.appendChild(q(e.services)),i.appendChild(t)}),i}async function L(){try{const n=_(m,"price");return(await h(y(n))).docs.map(e=>e.data().title).filter(Boolean)}catch(n){console.error("Ошибка при получении документов:",n)}}function x(n){const i=n??"Все услуги";v(".button_list-item").forEach(t=>{t.innerText===i?d(t,"add","button_list-item-active"):d(t,"remove","button_list-item-active")})}async function M(){const n=r(".tubs__lists"),i=r(".tubs__buttons-list"),e=r(".tubs"),t=r(".loader"),a=f().getParam("active"),p=await L(),o=await b(a);p.forEach(u=>{const l=c("button",["tubs__button","button_list-item"]),w=c("li","tubs__button-item");l.innerText=u,w.appendChild(l),i.appendChild(w)}),x(a),n.append(C(o)),e.style.opacity="1",t.style.opacity="0",t.style.eventPointer="none",t.style.zIndex="-1"}async function A(){const n=r(".tubs__lists"),i=v(".tubs__button"),e=f();i.forEach(t=>{t.addEventListener("click",async s=>{if(console.log(e.getParam("active")),console.log(t.innerText),e.getParam("active")===t.innerText)return;const a=await b(t.innerText);n.innerHTML="",n.append(C(a)),x(t.innerText),e.setParam("active",s.target.innerText)})})}async function D(n){if(!n)return[];const i=y(_(m,"price"),S("title"),T(n),P(n+""));return(await h(i)).docs.map(t=>({id:t.id,...t.data()}))}async function H(){const n=r(".input__text-search"),i=r("input",n),e=r(".tubs__lists"),t=f(),s=v(".tubs__button"),a=r(".tubs__not-found");i.addEventListener("input",async o=>{i.value===""&&s.forEach(l=>{l.innerText==="Все услуги"?d(l,"add","button_list-item-active"):d(l,"remove","button_list-item-active")});const u=i.value?await p(g(i.value)):await b();if(e.innerHTML="",!u.length){a.style.opacity="1";return}a.style.opacity="0",e.append(C(u))});async function p(o){return t.deleteParam("active",!0),s.forEach(u=>{d(u,"remove","button_list-item-active")}),await D(g(o))}}document.addEventListener("DOMContentLoaded",async n=>{B(),await M(),await A(),await H()});
