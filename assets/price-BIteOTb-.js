import{r as c,b as y,c as b,g as o,i as H}from"./header--BVm7LaD.js";import{c as C,d as w,q as v,w as D,g as E}from"./firebase-D0A0i6wl.js";import{u as x}from"./use-query-DC4Lgv9E.js";import{c as S}from"./capitalize-name-C89BSpDV.js";async function q(n){const e=n!=="Все услуги"?n:null;try{const i=C(w,"price"),t=e?v(i,D("title","==",e)):v(i);return(await E(t)).docs.map(a=>({id:a.id,...a.data()}))}catch(i){console.error("Ошибка при получении документов:",i)}}function B(n){const e=c("ul","type-price__list");return n.forEach(i=>{const t=c("li","type-price__service-price"),s=c("p","type-price__name-service");s.textContent=i.name;const a=c("p","type-price__price-service");a.textContent=i.price,t.appendChild(s),t.appendChild(a),e.appendChild(t)}),e}function g(n){const e=document.createDocumentFragment();return n.forEach(i=>{const t=c("li",["tubs__lists-item","type-price"]),s=c("h5","type-price__title");s.textContent=i.title,t.appendChild(s);const a=c("p","type-price__description");a.textContent="Цены указаны в молдавских леях за одну процедуру/сеанс для одного животного",t.appendChild(a),i.categories&&i.categories.forEach(l=>{const p=c("div","type-price__sub-title");p.textContent=l.subTitle,t.appendChild(p),t.appendChild(B(l.services))}),i.services&&t.appendChild(B(i.services)),e.appendChild(t)}),e}async function L(){try{const n=C(w,"price");return(await E(v(n))).docs.map(i=>i.data().title).filter(Boolean)}catch(n){console.error("Ошибка при получении документов:",n)}}function T(n){const e=n??"Все услуги";y(".button_list-item").forEach(t=>{t.innerText===e?b(t,"add","button_list-item-active"):b(t,"remove","button_list-item-active")})}async function W(){const n=o(".tubs__lists"),e=o(".tubs__buttons-list"),i=o(".tubs"),t=o(".loader"),a=x().getParam("active"),l=await L(),p=await q(a);l.forEach(f=>{const h=c("button",["tubs__button","button_list-item"]),d=c("li","tubs__button-item");h.innerText=f,d.appendChild(h),e.appendChild(d)}),T(a),n.append(g(p)),i.style.opacity="1",t.style.opacity="0",t.style.eventPointer="none",t.style.zIndex="-1"}async function M(){const n=o(".tubs__lists"),e=y(".tubs__button"),i=x();e.forEach(t=>{t.addEventListener("click",async s=>{if(i.getParam("active")===t.innerText)return;const a=await q(t.innerText);n.innerHTML="",n.append(g(a)),T(t.innerText)})})}async function z(n){if(!n)return[];const e=v(C(w,"price")),t=(await E(e)).docs.map(s=>({id:s.id,...s.data()}));return console.log(t),console.log(n),t.filter(s=>s.title.toLowerCase().includes(n.toLowerCase()))}async function F(){const n=o(".input__text-search"),e=o("input",n),i=o(".tubs__lists"),t=x(),s=y(".tubs__button"),a=o(".tubs__not-found"),l=o(".input__text-search-button"),p=y(".tubs__button-item"),f=o(".button_all-service");l.addEventListener("click",async d=>{e.value===""&&(s.forEach(r=>{r.innerText==="Все услуги"?b(r,"add","button_list-item-active"):b(r,"remove","button_list-item-active")}),p.forEach(r=>{r.style.display="block"}),t.deleteParam("active"));const u=e.value?await h(S(e.value)):await q();if(i.innerHTML="",e.value!==""&&(t.setParam("active",e.value),y(".tubs__button-item").forEach(_=>{const m=o(".button_list-item",_);m.innerText==="Все услуги"||m.innerText.includes(e.value)?_.style.display="block":_.style.display="none"})),!u.length){a.style.opacity="1";return}a.style.opacity="0",i.append(g(u))}),f.addEventListener("click",async d=>{const u=o(".tubs__buttons-list"),r=await L();e.value="",t.deleteParam("active"),u.innerHTML="",r.unshift("Все услуги"),r.forEach(_=>{const m=c("button",["tubs__button","button_list-item"]),P=c("li","tubs__button-item");m.innerText=_,P.appendChild(m),u.appendChild(P)}),T("Все услуги"),await M()});async function h(d){return s.forEach(u=>{b(u,"remove","button_list-item-active")}),await z(S(d))}}document.addEventListener("DOMContentLoaded",async n=>{H(),await W(),await M(),await F()});
