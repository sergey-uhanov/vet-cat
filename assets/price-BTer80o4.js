import{c as _,d as m,q as y,w as g,a as h,r as c,b as v,e as d,g as r,j as P,s as S,o as T,i as B}from"./firebase-C_D9rmmj.js";import{u as f}from"./use-query-DC4Lgv9E.js";import{c as q}from"./capitalize-name-C89BSpDV.js";async function b(e){const i=e!=="Все услуги"?e:null;try{const n=_(m,"price"),t=i?y(n,g("title","==",i)):y(n);return(await h(t)).docs.map(a=>({id:a.id,...a.data()}))}catch(n){console.error("Ошибка при получении документов:",n)}}function E(e){const i=c("ul","type-price__list");return e.forEach(n=>{const t=c("li","type-price__service-price"),s=c("p","type-price__name-service");s.textContent=n.name;const a=c("p","type-price__price-service");a.textContent=n.price,t.appendChild(s),t.appendChild(a),i.appendChild(t)}),i}function C(e){const i=document.createDocumentFragment();return e.forEach(n=>{const t=c("li",["tubs__lists-item","type-price"]),s=c("h5","type-price__title");s.textContent=n.title,t.appendChild(s);const a=c("p","type-price__description");a.textContent="Цены указаны в молдавских леях за одну процедуру/сеанс для одного животного",t.appendChild(a),n.categories&&n.categories.forEach(p=>{const o=c("div","type-price__sub-title");o.textContent=p.subTitle,t.appendChild(o),t.appendChild(E(p.services))}),n.services&&t.appendChild(E(n.services)),i.appendChild(t)}),i}async function L(){try{const e=_(m,"price");return(await h(y(e))).docs.map(n=>n.data().title).filter(Boolean)}catch(e){console.error("Ошибка при получении документов:",e)}}function x(e){const i=e??"Все услуги";v(".button_list-item").forEach(t=>{t.innerText===i?d(t,"add","button_list-item-active"):d(t,"remove","button_list-item-active")})}async function M(){const e=r(".tubs__lists"),i=r(".tubs__buttons-list"),n=r(".tubs"),t=r(".loader"),a=f().getParam("active"),p=await L(),o=await b(a);p.forEach(u=>{const l=c("button",["tubs__button","button_list-item"]),w=c("li","tubs__button-item");l.innerText=u,w.appendChild(l),i.appendChild(w)}),x(a),e.append(C(o)),n.style.opacity="1",t.style.opacity="0",t.style.eventPointer="none",t.style.zIndex="-1"}async function A(){const e=r(".tubs__lists"),i=v(".tubs__button"),n=f();i.forEach(t=>{t.addEventListener("click",async s=>{const a=await b(t.innerText);e.innerHTML="",e.append(C(a)),x(t.innerText),n.setParam("active",s.target.innerText)})})}async function D(e){if(!e)return[];const i=y(_(m,"price"),T("title"),S(e),P(e+""));return(await h(i)).docs.map(t=>({id:t.id,...t.data()}))}async function H(){const e=r(".input__text-search"),i=r("input",e),n=r(".tubs__lists"),t=f(),s=v(".tubs__button"),a=r(".tubs__not-found");i.addEventListener("input",async o=>{i.value===""&&s.forEach(l=>{l.innerText==="Все услуги"?d(l,"add","button_list-item-active"):d(l,"remove","button_list-item-active")});const u=i.value?await p(q(i.value)):await b();if(n.innerHTML="",!u.length){a.style.opacity="1";return}a.style.opacity="0",n.append(C(u))});async function p(o){return t.deleteParam("active",!0),s.forEach(u=>{d(u,"remove","button_list-item-active")}),await D(q(o))}}document.addEventListener("DOMContentLoaded",async e=>{B(),await M(),await A(),await H()});
