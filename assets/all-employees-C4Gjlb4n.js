import{g as u,r as E,b as l,c,m as _,i as x,s as v}from"./header--BVm7LaD.js";import{c as b,d as h,w as P,q as T,g as L}from"./firebase-D0A0i6wl.js";import{u as m}from"./use-query-DC4Lgv9E.js";import{r as w}from"./render-img-cards-CYRWRu-9.js";async function g(n,t){try{let e=b(h,"cards-experts");const r=[];return n&&n!=="Везде"&&r.push(P("location","==",n)),e=T(e,...r),(await L(e)).docs.map(i=>({id:i.id,...i.data()}))}catch(e){return console.error("Ошибка при получении сотрудников:",e),[]}}function q(n){const t=u(".employees-tubs__cards");if(!n.length){t.innerHTML='<div class="employees-tubs__empty-cards">Нечего не найденно!</div>';return}t.innerHTML="",n.forEach(e=>{t.insertAdjacentHTML("beforeend",w(e))})}async function M(){const n=u(".employees-tubs__buttons-block"),t=m(),e=t.getParam("location")?t.getParam("location"):"Везде",r=t.getParam("Expert")?t.getParam("Expert"):"Все специализации",i=(await g(e)).reduce((o,{expertise:a})=>(o.includes(a)||o.push(a),o),[]);i.unshift("Все специализации"),n.innerHTML="",i.forEach(o=>{const a=E("button",["button_list-item","button_all-service",r===o?"button_list-item-active":""]);a.innerText=o,n.append(a)})}function Q(n){const t=u(`.${n}`);t.innerHTML='<span class="loader"></span>'}async function f(){const n=u(".employees-tubs__content"),t=m(),e=t.getParam("location"),r=t.getParam("Expert");n.style.opacity="0";let s;e||t.setParam("location","Везде"),r||t.setParam("Expert","Все специализации");try{s=await g(t.getParam("location")),d(s,r),await M(s),await i(),B(e),n.style.opacity="1"}catch(o){console.error(o)}function i(){const o=l(".button_list-item");o.forEach(a=>{a.addEventListener("click",async()=>{a.innerText!==t.getParam("Expert")&&(t.setParam("Expert",a.innerText),o.forEach(p=>{const y=t.getParam("Expert");p.innerText===y?c(p,"add","button_list-item-active"):c(p,"remove","button_list-item-active")}),d(s,a.innerText))})})}}function d(n,t){Q("employees-tubs__cards");const e=n.filter(r=>t==="Все специализации"?!0:t===r.expertise);q(e)}function B(n){l(".button-group__button").forEach(e=>{e.innerText===n?(c(e,"add","button-group__button_active"),_(e)):c(e,"remove","button-group__button_active")})}async function H(){const n=l(".button_list-item"),t=m();n.forEach(e=>{e.addEventListener("click",async()=>{e.innerText!==t.getParam("Expert")&&(console.log(1),console.log(e.innerText===t.getParam("Expert")),t.setParam("Expert",e.innerText),n.forEach(r=>{const s=t.getParam("Expert");r.innerText===s?c(r,"add","button_list-item-active"):c(r,"remove","button_list-item-active")}))})})}async function C(){const n=u(".button-group__container"),t=l(".button-group__button",n),e=m();t.forEach(r=>{r.addEventListener("click",()=>{r.innerText!==e.getParam("location")&&(e.setParam("location",r.innerText),f())})})}document.addEventListener("DOMContentLoaded",async n=>{x(),v(),await f(),await H(),await C()});
